{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport { STYLES } from \"../styles/styles\";\nimport api from \"../api/axiosConfig\";\nimport FlightItem from \"../components/FlightItem\";\nimport RoundButton from \"../components/RoundButton\";\n\nvar FlightListScreen = function FlightListScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      refreshing = _useState4[0],\n      setRefreshing = _useState4[1];\n\n  var fetchData = function fetchData() {\n    var response;\n    return _regeneratorRuntime.async(function fetchData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setData([]);\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(api.get(\"/api/flights/\"));\n\n          case 3:\n            response = _context.sent;\n            setData(response.data);\n            onRefresh();\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    fetchData();\n    var refreshOnBack = navigation.addListener(\"focus\", function () {\n      fetchData();\n    });\n    return refreshOnBack;\n  }, [navigation]);\n\n  var wait = function wait(timeout) {\n    return new Promise(function (resolve) {\n      return setTimeout(resolve, timeout);\n    });\n  };\n\n  var onRefresh = useCallback(function () {\n    setRefreshing(true);\n    wait(250).then(function () {\n      return setRefreshing(false);\n    });\n  }, []);\n\n  var renderItem = function renderItem(_ref2) {\n    var item = _ref2.item;\n    return React.createElement(TouchableOpacity, {\n      activeOpacity: 0.7,\n      style: styles.touchable,\n      onPress: function onPress() {\n        return navigation.navigate(\"FlightDetail\", {\n          item: item\n        });\n      }\n    }, React.createElement(FlightItem, {\n      date: item.date,\n      route: item.route,\n      type: item.aircraft_type,\n      reg: item.registration,\n      dur: item.duration,\n      crew: item.second_in_command ? \"SIC\" : \"PIC\",\n      dayL: item.landings_day ? item.landings_day : 0,\n      nitL: item.landings_night ? item.landings_night : 0\n    }));\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.container\n  }, React.createElement(FlatList, {\n    data: data.results,\n    renderItem: renderItem,\n    keyExtractor: function keyExtractor(item) {\n      return item.id.toString();\n    },\n    refreshControl: React.createElement(RefreshControl, {\n      refreshing: refreshing,\n      onRefresh: onRefresh\n    })\n  }), React.createElement(RoundButton, {\n    buttonSize: 60,\n    iconName: \"plus\",\n    buttonColor: STYLES.green,\n    onPress: function onPress() {\n      return navigation.navigate(\"FlightCreate\");\n    }\n  }));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    flex: 1\n  },\n  item: {\n    width: \"100%\",\n    backgroundColor: STYLES.elementBackground,\n    padding: 10,\n    marginTop: 2,\n    marginRight: 10,\n    marginLeft: 10\n  },\n  text: {\n    fontSize: 16,\n    justifyContent: \"space-between\",\n    color: STYLES.blue\n  },\n  touchable: {\n    alignItems: \"center\",\n    backgroundColor: STYLES.highlight,\n    padding: 0,\n    marginTop: 2\n  }\n});\nexport default FlightListScreen;","map":{"version":3,"names":["React","useState","useEffect","useCallback","STYLES","api","FlightItem","RoundButton","FlightListScreen","navigation","data","setData","refreshing","setRefreshing","fetchData","get","response","onRefresh","refreshOnBack","addListener","wait","timeout","Promise","resolve","setTimeout","then","renderItem","item","styles","touchable","navigate","date","route","aircraft_type","registration","duration","second_in_command","landings_day","landings_night","container","results","id","toString","green","StyleSheet","create","width","flex","backgroundColor","elementBackground","padding","marginTop","marginRight","marginLeft","text","fontSize","justifyContent","color","blue","alignItems","highlight"],"sources":["/Users/blake/react_native/d2lb/app/screens/FlightListScreen.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  SafeAreaView,\n  FlatList,\n  StyleSheet,\n  TouchableOpacity,\n  RefreshControl,\n} from \"react-native\";\n\nimport { STYLES } from \"../styles/styles\";\nimport api from \"../api/axiosConfig\";\nimport FlightItem from \"../components/FlightItem\";\nimport RoundButton from \"../components/RoundButton\";\n\nconst FlightListScreen = ({ navigation }) => {\n  const [data, setData] = useState([]);\n  const [refreshing, setRefreshing] = useState(false);\n\n  const fetchData = async () => {\n    setData([]);\n    const response = await api.get(\"/api/flights/\");\n    setData(response.data);\n    onRefresh();\n  };\n\n  useEffect(() => {\n    fetchData();\n    const refreshOnBack = navigation.addListener(\"focus\", () => {\n      fetchData();\n    });\n\n    return refreshOnBack;\n  }, [navigation]);\n\n  const wait = (timeout) => {\n    return new Promise((resolve) => setTimeout(resolve, timeout));\n  };\n\n  const onRefresh = useCallback(() => {\n    setRefreshing(true);\n    wait(250).then(() => setRefreshing(false));\n  }, []);\n\n  const renderItem = ({ item }) => (\n    <TouchableOpacity\n      activeOpacity={0.7}\n      style={styles.touchable}\n      onPress={() =>\n        navigation.navigate(\"FlightDetail\", {\n          item: item,\n        })\n      }\n    >\n      <FlightItem\n        date={item.date}\n        route={item.route}\n        type={item.aircraft_type}\n        reg={item.registration}\n        dur={item.duration}\n        crew={item.second_in_command ? \"SIC\" : \"PIC\"}\n        dayL={item.landings_day ? item.landings_day : 0}\n        nitL={item.landings_night ? item.landings_night : 0}\n      />\n    </TouchableOpacity>\n  );\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <FlatList\n        data={data.results}\n        renderItem={renderItem}\n        keyExtractor={(item) => item.id.toString()}\n        refreshControl={\n          <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n        }\n      />\n      <RoundButton\n        buttonSize={60}\n        iconName='plus'\n        buttonColor={STYLES.green}\n        onPress={() => navigation.navigate(\"FlightCreate\")}\n      ></RoundButton>\n    </SafeAreaView>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    flex: 1,\n  },\n  item: {\n    width: \"100%\",\n    backgroundColor: STYLES.elementBackground,\n    padding: 10,\n    marginTop: 2,\n    marginRight: 10,\n    marginLeft: 10,\n  },\n  text: {\n    fontSize: 16,\n    justifyContent: \"space-between\",\n    color: STYLES.blue,\n  },\n  touchable: {\n    alignItems: \"center\",\n    backgroundColor: STYLES.highlight,\n    padding: 0,\n    marginTop: 2,\n  },\n});\n\nexport default FlightListScreen;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}